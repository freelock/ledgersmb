<?lsmb INCLUDE 'ui-header.html' ?>
<?lsmb PROCESS 'elements.html' ?>
<?lsmb PROCESS 'dynatable.html' ?>
<!-- 

The overall structure here is imagined to be a list of individual price
listings followed by the listings for the pricegroup.  The reason for including
both is simply that it makes it easier for someone to see what's going on when
checking a price deal for a customer.

-CT

-->
<?lsmb account_class = entity_class ?>
<body>
<div class="listtop"><?lsmb text('Pricelist') ?> <?lsmb pricematrix.length ?></div>
<?lsmb 
    columns = [ { col_id = 'int_partnumber'
                  name = text('Partnumber')
                  type = 'text'
                },
                { col_id = 'description'
                  name = text('Description')
                  type = 'text'
                } ];
     IF account_class == 1;
         columns.push(
                  {col_id = 'lastcost'
                     name = text('Last Cost') #'
                     type = 'text_input'},
                  {col_id = 'partnumber',
                     name = text('Vendor Partnumber') #'
                     type = 'text_input'},
                  {col_id = 'leadtime',
                     name = text('Lead Time') #'
                     type = 'input_text'}
         );
     ELSE;
         columns.push(
                  {col_id = 'sellprice'
                     name = text('Sell Price') #'
                     type = 'text_input'},
                  {col_id = 'validfrom',
                     name = text('Valid From') #'
                     type = 'text_input'},
                  {col_id = 'validto',
                     name = text('Valid To') #'
                     type = 'text_input'},
         );
                        
     END;
     columns.push({col_id = 'currency',
                     name = text('Currency'),
                     type = 'text'},
                  {col_id = 'delete',
                     name = '&nbsp;',
                     type = 'href',
                href_base = script _ '?action=delete_pricematrix&credit_id=' 
                            _ id _ '&entry_id=' }
     );
     FOREACH pm IN pricematrix;
         pm.delete = '[' _ text('Delete') _ ']';
         pm.row_id = pm.entry_id;
     END;
     PROCESS dynatable
         tbody = { rows = pricematrix }; ?>
<?lsmb IF pricematrix_pricegroup;
     PROCESS dynatable
         tbody = { rows = pricematrix_pricegroup };
       END ?>
</body>
</html>
